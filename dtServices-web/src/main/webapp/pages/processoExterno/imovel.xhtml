<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:p="http://primefaces.org/ui" xmlns:m="http://www.maerlin.com/jsf"
	xmlns:cat="http://java.sun.com/jsf/composite/component"
	xmlns:pe="http://primefaces.org/ui/extensions">

<p:fieldset legend="#{bundle.menu_cadastro_imovel}" toggleable="false"
	toggleSpeed="500">

	<h:panelGrid columns="2" id="endereco">
		<p:outputLabel value="Tipo do Imóvel" />
		<p:inputText size="60" label="Tipo do imóvel"
			value="#{processoEditMB.processo.imovel.tipoImovel}" rendered="false" />
		<p:outputLabel value="Tipo do Imóvel" rendered="true" />
			
		<p:outputLabel value="#{bundle.imovel_field_crp}" />
		<p:inputText size="60" label="#{bundle.imovel_field_crp}"
			value="#{processoEditMB.processo.imovel.crp}"
			required="true"
			validatorMessage="#{bundle.imovel_msg_invalidCrp}">
		</p:inputText>
		<p:outputLabel value="#{bundle.endereco_field_ruaPorta}" />
		<h:panelGrid columns="2">
			<p:inputText id="ruaPorta" size="60"
				label="#{bundle.endereco_field_ruaPorta}"
				value="#{processoEditMB.processo.imovel.ruaPorta}"
				required="true"
				validatorMessage="#{bundle.imovel_msg_invalidEndereco}">
			</p:inputText>
		</h:panelGrid>

		<p:outputLabel value="#{bundle.endereco_field_complemento}" />
		<p:inputText id="complemento" size="60"
			label="#{bundle.endereco_field_complemento}"
			value="#{processoEditMB.processo.imovel.complemento}"
			required="true">
		</p:inputText>

		<p:outputLabel value="#{bundle.endereco_field_cp}" />
		<h:panelGrid columns="2">
			<p:autoComplete id="cp" value="#{processoEditMB.processo.imovel.codigoPostal}"
				completeMethod="#{enderecoMB.search}" var="end"
				converter="enderecoConverter" itemLabel="#{end}"
				itemValue="#{end.id}" forceSelection="true" required="true">
				<p:ajax event="itemSelect"
					listener="#{processoEditMB.onEnderecoSelect}"
					update="ruaPorta,complemento,cp,concelho,distrito" />
				<p:column style="width:10%">
					<h:outputText value="#{end.codigoPostal}" />
				</p:column>

				<p:column>
					<h:outputText value="#{end.ruaPorta}" />
				</p:column>

				<p:column>
					<h:outputText value="#{end.complemento}" />
				</p:column>

				<p:column>
					<h:outputText value="#{end.concelho.nome}" />
				</p:column>

				<p:column>
					<h:outputText value="#{end.distrito.nome}" />
				</p:column>
			</p:autoComplete>
		</h:panelGrid>

		<p:outputLabel value="#{bundle.endereco_field_concelho}" />
		<p:selectOneMenu id="concelho"
			value="#{processoEditMB.processo.imovel.concelho.id}"
			style="width:125px" required="true"
			label="#{bundle.endereco_field_concelho}">
			<f:selectItems
				value="#{enderecoMB.getConcelhos(processoEditMB.processo.imovel.distrito)}"
				var="concelho" itemValue="#{concelho.id}"
				itemLabel="#{concelho.nome}" />
		</p:selectOneMenu>

		<p:outputLabel value="#{bundle.endereco_field_distrito}" />
		<p:selectOneMenu id="distrito"
			value="#{processoEditMB.processo.imovel.distrito.id}"
			style="width:125px" required="true"
			label="#{bundle.endereco_field_distrito}">
			<f:selectItems value="#{enderecoMB.distritos}" var="distrito"
				itemValue="#{distrito.id}" itemLabel="#{distrito.nome}" />
		</p:selectOneMenu>

		<p:outputLabel value="#{bundle.endereco_field_latitude}" />
		<p:inputText id="lat" size="30"
			label="#{bundle.endereco_field_latitude}"
			value="#{processoEditMB.processo.imovel.latitude}">
		</p:inputText>

		<p:outputLabel value="#{bundle.endereco_field_longitude}" />
		<p:inputText id="lng" size="30"
			label="#{bundle.endereco_field_longitude}"
			value="#{processoEditMB.processo.imovel.longitude}">
		</p:inputText>

	</h:panelGrid>
	
</p:fieldset>
</html>
